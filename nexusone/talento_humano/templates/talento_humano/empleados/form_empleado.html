{% extends 'base.html' %}
{% load static %}

{% block title %}{% if object %}Editar{% else %}Nuevo{% endif %} Empleado - Talento Humano{% endblock %}

{% block content %}
<div class="container mb-5">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="section-title">
            <i class="bi bi-person-fill-add"></i>
            {% if object %}Editar Empleado{% else %}Nuevo Empleado{% endif %}
        </h1>
        <a href="{% url 'talento_humano:lista_empleados' %}" class="btn-volver">
            <i class="bi bi-arrow-left"></i> Volver
        </a>
    </div>

    <!-- INDICADOR -->
    <div class="alert alert-info d-flex align-items-center gap-2 mb-4" style="background:#e0f2fe;border:none;">
        <i class="bi bi-info-circle-fill text-primary"></i>
        Los campos marcados con <span class="fw-bold text-danger">*</span> son obligatorios.
    </div>

    <!-- FORMULARIO -->
    <form method="post" enctype="multipart/form-data" id="empleadoForm">
        {% csrf_token %}

        {% if form.errors %}
        <div class="alert alert-danger mb-4">
            <i class="bi bi-exclamation-triangle-fill"></i>
            <strong>Revisa los campos con errores:</strong> {{ form.errors }}
        </div>
        {% endif %}

        <!-- TABS -->
        <ul class="nav nav-tabs mb-4 border-0">
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#personal" type="button"><i class="bi bi-person"></i> Personal</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#contacto" type="button"><i class="bi bi-telephone"></i> Contacto</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#laboral" type="button"><i class="bi bi-briefcase"></i> Laboral</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#salario" type="button"><i class="bi bi-cash-stack"></i> Salario</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#seguridad" type="button"><i class="bi bi-shield-check"></i> Seg. Social</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#bancaria" type="button"><i class="bi bi-bank"></i> Bancaria</button></li>
        </ul>

        <div class="tab-content bg-white p-4 rounded shadow-sm">
            <!-- ... tus tabs tal cual ... -->
            <!-- (no te los repito para no hacer demasiado largo el bloque) -->
        </div>

        <!-- BOTONES -->
        <div class="d-flex justify-content-end gap-3 mt-4">
            <a href="{% url 'talento_humano:lista_empleados' %}" class="btn-outline">
                <i class="bi bi-x-circle"></i> Cancelar
            </a>
            <button type="submit" class="btn-verde">
                <i class="bi bi-check2-circle"></i>
                {% if object %}Actualizar{% else %}Guardar{% endif %} Empleado
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('id_foto').style.display = 'none';
const fotoInput = document.getElementById('id_foto');
fotoInput?.addEventListener('change', e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    const preview = document.getElementById('photoPreview');
    preview.src = ev.target.result;
    preview.classList.remove('d-none');
  };
  reader.readAsDataURL(file);
});
</script>
{% endblock %}
